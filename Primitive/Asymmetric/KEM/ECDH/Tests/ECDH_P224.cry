/*
 * Test vectors for the ECC-CDH primitive, instantiated with P-224.
 *
 * These are drawn from the NIST Cryptographic Algorithm Validation Program
 * (CAVP) Individual Component Testing. The CAVP provides validation testing
 * of approved cryptographic algorithms. This implementation has not been
 * formally validated, but the program provides test vectors to informally
 * verify the correctness of the components.
 * @see https://csrc.nist.gov/Projects/cryptographic-algorithm-validation-program/Component-Testing
 *
 * @copyright Galois, Inc
 * @author Ryan Scott <rscott@galois.com>
 */
module Primitive::Asymmetric::KEM::ECDH::Tests::ECDH_P224 where
import Primitive::Asymmetric::KEM::ECDH::Instantiations::ECDH_P224 as ECDH
import Common::EC::PrimeField::Instantiations::P224 as P224
import Common::utils(BVtoZ)

/**
 * Run a single instance of the CAVP test vectors:
 * - Validate the IUT key pair
 * - Validate the CAVP public key
 * - Verify the shared secret generated by ECC-CDH
 *
 * "IUT" stands for "implementation under test".
 */
cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy Z = zMatches && iutKeysValid && cavsKeyValid where
    Q_C = P224::Affine (BVtoZ QCAVSx) (BVtoZ QCAVSy)
    Q_I = P224::Affine (BVtoZ QIUTx) (BVtoZ QIUTy)
    d_I = BVtoZ dIUT
    zMatches = case ECDH::ECC_CDH d_I Q_C of
        Some actualZ -> actualZ == (split Z)
        None -> False
    iutKeysValid = ECDH::signingKeyValid d_I
        && ECDH::verifyingKeyFullyValid Q_I
        && ECDH::keyPairIsConsistent d_I Q_I
    cavsKeyValid = ECDH::verifyingKeyFullyValid Q_C

/**
 * ```repl
 * :prove cavpTest0
 * ```
 */
property cavpTest0 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0xaf33cd0629bc7e996320a3f40368f74de8704fa37b8fab69abaae280
    QCAVSy = 0x882092ccbba7930f419a8a4f9bb16978bbc3838729992559a6f2e2d7
    dIUT = 0x8346a60fc6f293ca5a0d2af68ba71d1dd389e5e40837942df3e43cbd
    QIUTx = 0x8de2e26adf72c582d6568ef638c4fd59b18da171bdf501f1d929e048
    QIUTy = 0x4a68a1c2b0fb22930d120555c1ece50ea98dea8407f71be36efac0de
    ZIUT = 0x7d96f9a3bd3c05cf5cc37feb8b9d5209d5c2597464dec3e9983743e8

/**
 * ```repl
 * :prove cavpTest1
 * ```
 */
property cavpTest1 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x13bfcd4f8e9442393cab8fb46b9f0566c226b22b37076976f0617a46
    QCAVSy = 0xeeb2427529b288c63c2f8963c1e473df2fca6caa90d52e2f8db56dd4
    dIUT = 0x043cb216f4b72cdf7629d63720a54aee0c99eb32d74477dac0c2f73d
    QIUTx = 0x2f90f5c8eac9c7decdbb97b6c2f715ab725e4fe40fe6d746efbf4e1b
    QIUTy = 0x66897351454f927a309b269c5a6d31338be4c19a5acfc32cf656f45c
    ZIUT = 0xee93ce06b89ff72009e858c68eb708e7bc79ee0300f73bed69bbca09

/**
 * ```repl
 * :prove cavpTest2
 * ```
 */
property cavpTest2 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x756dd806b9d9c34d899691ecb45b771af468ec004486a0fdd283411e
    QCAVSy = 0x4d02c2ca617bb2c5d9613f25dd72413d229fd2901513aa29504eeefb
    dIUT = 0x5ad0dd6dbabb4f3c2ea5fe32e561b2ca55081486df2c7c15c9622b08
    QIUTx = 0x005bca45d793e7fe99a843704ed838315ab14a5f6277507e9bc37531
    QIUTy = 0x43e9d421e1486ae5893bfd23c210e5c140d7c6b1ada59d842c9a98de
    ZIUT = 0x3fcc01e34d4449da2a974b23fc36f9566754259d39149790cfa1ebd3

/**
 * ```repl
 * :prove cavpTest3
 * ```
 */
property cavpTest3 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x0f537bf1c1122c55656d25e8aa8417e0b44b1526ae0523144f9921c4
    QCAVSy = 0xf79b26d30e491a773696cc2c79b4f0596bc5b9eebaf394d162fb8684
    dIUT = 0x0aa6ff55a5d820efcb4e7d10b845ea3c9f9bc5dff86106db85318e22
    QIUTx = 0x2f96754131e0968198aa78fbe8c201dc5f3581c792de487340d32448
    QIUTy = 0x61e8a5cd79615203b6d89e9496f9e236fe3b6be8731e743d615519c6
    ZIUT = 0x49129628b23afcef48139a3f6f59ff5e9811aa746aa4ff33c24bb940

/**
 * ```repl
 * :prove cavpTest4
 * ```
 */
property cavpTest4 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x2b3631d2b06179b3174a100f7f57131eeea8947be0786c3dc64b2239
    QCAVSy = 0x83de29ae3dad31adc0236c6de7f14561ca2ea083c5270c78a2e6cbc0
    dIUT = 0xefe6e6e25affaf54c98d002abbc6328da159405a1b752e32dc23950a
    QIUTx = 0x355e962920bde043695f6bffb4b355c63da6f5de665ed46f2ec817e2
    QIUTy = 0x748e095368f62e1d364edd461719793b404adbdaacbcadd88922ff37
    ZIUT = 0xfcdc69a40501d308a6839653a8f04309ec00233949522902ffa5eac6

/**
 * ```repl
 * :prove cavpTest5
 * ```
 */
property cavpTest5 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x4511403de29059f69a475c5a6a5f6cabed5d9f014436a8cb70a02338
    QCAVSy = 0x7d2d1b62aa046df9340f9c37a087a06b32cf7f08a223f992812a828b
    dIUT = 0x61cb2932524001e5e9eeed6df7d9c8935ee3322029edd7aa8acbfd51
    QIUTx = 0xd50e4adabfd989d7dbc7cf4052546cc7c447a97630436997ad4b9536
    QIUTy = 0x5bea503473c5eaef9552d42c40b1f2f7ca292733b255b9bbe1b12337
    ZIUT = 0x827e9025cb62e0e837c596063f3b9b5a0f7afd8d8783200086d61ec1

/**
 * ```repl
 * :prove cavpTest6
 * ```
 */
property cavpTest6 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x314a0b26dd31c248845d7cc17b61cad4608259bed85a58d1f1ffd378
    QCAVSy = 0x66e4b350352e119eecada382907f3619fd748ea73ae4899dfd496302
    dIUT = 0x8c7ace347171f92def98d845475fc82e1d1496da81ee58f505b985fa
    QIUTx = 0xb1a8dcac89aca2799320b451df1c7ff4d97567abb68141c0d95fc2aa
    QIUTy = 0x3524950902b1510bdc987d860afc27ad871ceaea66935abd3c0a99a8
    ZIUT = 0x335ba51228d94acbed851ca7821c801d5cb1c7975d7aa90a7159f8fa

/**
 * ```repl
 * :prove cavpTest7
 * ```
 */
property cavpTest7 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0xabe6843beec2fd9e5fb64730d0be4d165438ce922ed75dd80b4603e5
    QCAVSy = 0x6afe8673a96c4ba9900ad85995e631e436c6cc88a2c2b47b7c4886b8
    dIUT = 0x382feb9b9ba10f189d99e71a89cdfe44cb554cec13a212840977fb68
    QIUTx = 0xabb6f1e3773ff8fc73aea2a0b107809ce70adcefed6e41fc5cb43045
    QIUTy = 0xa963897ae906c10a055eeadb97ffdd6f748d3e5621e5fff304e48ba7
    ZIUT = 0x8c2e627594206b34f7356d3426eb3d79f518ef843fbe94014cceace3

/**
 * ```repl
 * :prove cavpTest8
 * ```
 */
property cavpTest8 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x13cf9d6d2c9aae8274c27d446afd0c888ffdd52ae299a35984d4f527
    QCAVSy = 0xdcbee75b515751f8ee2ae355e8afd5de21c62a939a6507b538cbc4af
    dIUT = 0xe0d62035101ef487c485c60fb4500eebe6a32ec64dbe97dbe0232c46
    QIUTx = 0x88537735e9b23e3e0e076f135a82d33f9bffb465f3abce8322a62a62
    QIUTy = 0xb4c8c123673197875c0bd14ed097606d330fba2b9200ef65a44764d3
    ZIUT = 0x632abb662728dbc994508873d5c527ca5ef923c0d31fa6c47ef4c825

/**
 * ```repl
 * :prove cavpTest9
 * ```
 */
property cavpTest9 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x965b637c0dfbc0cf954035686d70f7ec30929e664e521dbaa2280659
    QCAVSy = 0x82a58ff61bc90019bbcbb5875d3863db0bc2a1fa34b0ad4de1a83f99
    dIUT = 0xb96ade5b73ba72aa8b6e4d74d7bf9c58e962ff78eb542287c7b44ba2
    QIUTx = 0x37682926a54f70a4c1748f54d50d5b00138a055f924f2c65e5b0bbe4
    QIUTy = 0x596afefcdd640d29635015b89bdddd1f8c2723686d332e7a06ca8799
    ZIUT = 0x34641141aab05ef58bd376d609345901fb8f63477c6be9097f037f1f

/**
 * ```repl
 * :prove cavpTest10
 * ```
 */
property cavpTest10 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x73cc645372ca2e71637cda943d8148f3382ab6dd0f2e1a49da94e134
    QCAVSy = 0xdf5c355c23e6e232ebc3bee2ab1873ee0d83e3382f8e6fe613f6343c
    dIUT = 0xa40d7e12049c71e6522c7ff2384224061c3a457058b310557655b854
    QIUTx = 0x399801243bfe0c2da9b0a53c8ca57f2eee87aaa94a8e4d5e029f42ca
    QIUTy = 0xaa49e6d4b47cee7a5c4ab71d5a67da84e0b9b425ce3e70da68c889e7
    ZIUT = 0x4f74ac8507501a32bfc5a78d8271c200e835966e187e8d00011a8c75

/**
 * ```repl
 * :prove cavpTest11
 * ```
 */
property cavpTest11 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x546578216250354e449e21546dd11cd1c5174236739acad9ce0f4512
    QCAVSy = 0xd2a22fcd66d1abedc767668327c5cb9c599043276239cf3c8516af24
    dIUT = 0xad2519bc724d484e02a69f05149bb047714bf0f5986fac2e222cd946
    QIUTx = 0xdf9c1e0ef15e53b9f626e2be1cbe893639c06f3e0439ee95d7d4b1e3
    QIUTy = 0x7a52a7386adda243efdf8941085c84e31239cab92b8017336748965e
    ZIUT = 0xad09c9ae4d2324ea81bb555b200d3c003e22a6870ee03b52df49e4de

/**
 * ```repl
 * :prove cavpTest12
 * ```
 */
property cavpTest12 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x1d46b1dc3a28123cb51346e67baec56404868678faf7d0e8b2afa22a
    QCAVSy = 0x0ec9e65ec97e218373e7fc115c2274d5b829a60d93f71e01d58136c3
    dIUT = 0x3d312a9b9d8ed09140900bbac1e095527ebc9e3c6493bcf3666e3a29
    QIUTx = 0xb4a0198dc8810e884425b750928b0c960c31f7a99663400b01a179df
    QIUTy = 0x812b601bfc0738242c6f86f830f27acd632ca618a0b5280c9d5769f7
    ZIUT = 0xef029c28c68064b8abd2965a38c404fb5e944ace57e8638daba9d3cd

/**
 * ```repl
 * :prove cavpTest13
 * ```
 */
property cavpTest13 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x266d038cc7a4fe21f6c976318e827b82bb5b8f7443a55298136506e0
    QCAVSy = 0xdf123d98a7a20bbdf3943df2e3563422f8c0cf74d53aaabdd7c973ba
    dIUT = 0x8ce0822dc24c153995755ac350737ef506641c7d752b4f9300c612ed
    QIUTx = 0x00dfc7ec137690cd6d12fdb2fd0b8c5314582108769c2b722ffb3958
    QIUTy = 0x5eef3da4ba458127346bb64023868bddb7558a2ecfc813645f4ce9fe
    ZIUT = 0xf83c16661dfcbad021cc3b5a5af51d9a18db4653866b3ff90787ce3e

/**
 * ```repl
 * :prove cavpTest14
 * ```
 */
property cavpTest14 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0xeb0a09f7a1c236a61f595809ec5670efd92e4598d5e613e092cdfdca
    QCAVSy = 0x50787ae2f2f15b88bc10f7b5f0aee1418373f16153aebd1fba54288d
    dIUT = 0x0ff9b485325ab77f29e7bc379fed74bfac859482da0dee7528c19db2
    QIUTx = 0x7e603e6976db83c36011508fa695d1b515249e2e54b48fcbcfb90247
    QIUTy = 0x0179a600ce86adfca9b1b931fa5173d618da09e841803d19b0264286
    ZIUT = 0xf51258c63f232e55a66aa25ebd597b2018d1052c02eeb63866758005

/**
 * ```repl
 * :prove cavpTest15
 * ```
 */
property cavpTest15 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x6b2f6b18a587f562ffc61bd9b0047322286986a78f1fd139b84f7c24
    QCAVSy = 0x7096908e4615266be59a53cd655515056ff92370a6271a5d3823d704
    dIUT = 0x19cf5ff6306467f28b9fe0675a43c0582552c8c12e59ce7c38f292b1
    QIUTx = 0xfc20e906e609c112cfc2e0fea6303882c5db94e87e022373ab2c082a
    QIUTy = 0xaecdf1daa71782bc5a26bbbd8d7e8a76490e26abc17dffc774bd7341
    ZIUT = 0x7fdc969a186ff18429f2a276dac43beea21182d82ce2e5a0876552b1

/**
 * ```repl
 * :prove cavpTest16
 * ```
 */
property cavpTest16 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x328101ba826acd75ff9f34d5574ce0dbc92f709bad8d7a33c47940c1
    QCAVSy = 0xdf39f1ea88488c55d5538160878b9ced18a887ea261dd712d14024ff
    dIUT = 0x90a15368e3532c0b1e51e55d139447c2c89bc160719d697291ea7c14
    QIUTx = 0xc6837d506e976da7db3ad1267c359dff2ea6fb0b7f7f8e77024c59e9
    QIUTy = 0x67eb491d2fc8a530c46525d2a8b2d7c1df5fba1ae740a4649c683ee6
    ZIUT = 0x3d60ab6db2b3ffe2d29ccff46d056e54230cf34982e241556ed2920c

/**
 * ```repl
 * :prove cavpTest17
 * ```
 */
property cavpTest17 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x0081e34270871e2ebbd94183f617b4ae15f0416dd634fe6e934cf3c0
    QCAVSy = 0x3a1e9f38a7b90b7317d26b9f6311063ab58b268cf489b2e50386d5d6
    dIUT = 0x8e0838e05e1721491067e1cabc2e8051b290e2616eec427b7121897d
    QIUTx = 0xe9150f770075626019e18f95473b71e6828041791d3f08d3faeeaa2b
    QIUTy = 0x475f70735eaae52308a3b763dc88efe18ab590ebafa035f6e08b001c
    ZIUT = 0x9116d72786f4db5df7a8b43078c6ab9160d423513d35ea5e2559306d

/**
 * ```repl
 * :prove cavpTest18
 * ```
 */
property cavpTest18 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x2623632fdf0bd856805a69aa186d4133ef5904e1f655a972d66cce07
    QCAVSy = 0x2cef9728dd06fb8b50150f529b695076d4507983912585c89bd0682e
    dIUT = 0x38106e93f16a381adb1d72cee3da66ae462ad4bbfea9ecdf35d0814e
    QIUTx = 0x7be6c4c917829ab657dd79e8637d7aefd2f81f0de7654d957e97658d
    QIUTy = 0x430d22d9e8438310f61e0d43f25fa3e34585f432baad27db3021bf0d
    ZIUT = 0x207c53dcefac789aaa0276d9200b3a940ce5f2296f4cb2e81a185d3d

/**
 * ```repl
 * :prove cavpTest19
 * ```
 */
property cavpTest19 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x8ee4d1dcc31dee4bf6fe21ca8a587721d910acfb122c16c2a77a8152
    QCAVSy = 0x4ebf323fff04eb477069a0ac68b345f6b1ae134efc31940e513cb99f
    dIUT = 0xe5d1718431cf50f6cbd1bc8019fa16762dfa12c989e5999977fb4ea2
    QIUTx = 0x2ea4966e7f92ed7f5cc61fde792045f63b731d6e7d0de2577f2d8ece
    QIUTy = 0x1c4a7b1ede6f839162292df424be78e8176fb6f942a3c02391700f31
    ZIUT = 0x10e467da34f48ad7072005bccd6da1b2ba3f71eafa1c393842f91d74

/**
 * ```repl
 * :prove cavpTest20
 * ```
 */
property cavpTest20 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x97dcbe6d28335882a6d193cc54a1063dd0775dc328565300bb99e691
    QCAVSy = 0xdad11dd5ece8cfd9f97c9a526e4a1506e6355969ee87826fc38bcd24
    dIUT = 0x3d635691b62a9a927c633951c9369c8862bd2119d30970c2644727d6
    QIUTx = 0x438bbb980517afb20be1d674e3ac2b31cef07a9b23fb8f6e38e0d6c0
    QIUTy = 0x0be5f1c47d58d21b6ed28423b32f5a94750da47edcef33ea79942afd
    ZIUT = 0x82fd2f9c60c4f999ac00bbe64bfc11da8ff8cda2e499fced65230bb1

/**
 * ```repl
 * :prove cavpTest21
 * ```
 */
property cavpTest21 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0xce9126dd53972dea1de1d11efef900de34b661859c4648c5c0e534f7
    QCAVSy = 0xe113b6f2c1659d07f2716e64a83c18bbce344dd2121fe85168eae085
    dIUT = 0xacf3c85bbdc379f02f5ea36e7f0f53095a9e7046a28685a8659bf798
    QIUTx = 0xff7511215c71d796bd646e8474be4416b91684ce0d269ef6f422013b
    QIUTy = 0xb7bf5e79b5a9393bb9ea42c0bdb2d3c2dc806e1a7306aa58e4fdbea5
    ZIUT = 0x530f7e7fc932613b29c981f261cb036cba3f1df3864e0e1cba2685a2

/**
 * ```repl
 * :prove cavpTest22
 * ```
 */
property cavpTest22 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x84419967d6cfad41e75a02b6da605a97949a183a97c306c4b46e66a5
    QCAVSy = 0x5cc9b259718b1bc8b144fde633a894616ffd59a3a6d5d8e942c7cbb7
    dIUT = 0xcffd62cb00a0e3163fbf2c397fadc9618210f86b4f54a675287305f0
    QIUTx = 0x04bf4d948f4430d18b4ed6c96dbaf981fa11a403ed16887f06754981
    QIUTy = 0x7c1326a9cef51f79d4e78303d6064b459f612584ac2fdf593d7d5d84
    ZIUT = 0x49f6fd0139248ef4df2db05d1319bd5b1489e249827a45a8a5f12427

/**
 * ```repl
 * :prove cavpTest23
 * ```
 */
property cavpTest23 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x7c9cac35768063c2827f60a7f51388f2a8f4b7f8cd736bd6bc337477
    QCAVSy = 0x29ee6b849c6025d577dbcc55fbd17018f4edbc2ef105b004d6257bcd
    dIUT = 0x85f903e43943d13c68932e710e80de52cbc0b8f1a1418ea4da079299
    QIUTx = 0x970a4a7e01d4188497ceb46955eb1b842d9085819a9b925c84529d3d
    QIUTy = 0xdfa2526480f833ea0edbd204e4e365fef3472888fe7d9691c3ebc09f
    ZIUT = 0x8f7e34e597ae8093b98270a74a8dfcdbed457f42f43df487c5487161

/**
 * ```repl
 * :prove cavpTest24
 * ```
 */
property cavpTest24 = cavpTest QCAVSx QCAVSy dIUT QIUTx QIUTy ZIUT where
    QCAVSx = 0x085a7642ad8e59b1a3e8726a7547afbecffdac1dab7e57230c6a9df4
    QCAVSy = 0xf91c36d881fe9b8047a3530713554a1af4c25c5a8e654dcdcf689f2e
    dIUT = 0xcce64891a3d0129fee0d4a96cfbe7ac470b85e967529057cfa31a1d9
    QIUTx = 0xa6b29632db94da2125dc1cf80e03702687b2acc1122022fa2174765a
    QIUTy = 0x61723edd73e10daed73775278f1958ba56f1fc9d085ebc2b64c84fe5
    ZIUT = 0x71954e2261e8510be1a060733671d2e9d0a2d012eb4e09556d697d2a
