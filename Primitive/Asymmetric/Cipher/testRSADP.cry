/**
 * This module validates RSADP by testing on NIST's test vectors available at
 * https://csrc.nist.gov/projects/cryptographic-algorithm-validation-program/component-testing
 *
 * Copyright (c) 2018, Galois Inc.
 * www.cryptol.net
 *
 * Author: Ajay Kumar Eeralla
 *
 */

module Primitive::Asymmetric::Cipher::testRSADP where
import Primitive::Asymmetric::Cipher::RSA

rsaTest0 = {
n = 0xd0b750c8554b64c7a9d34d068e020fb52fea1b39c47971a359f0eec5da0437ea3fc94597d8dbff5444f6ce5a3293ac89b1eebb3f712b3ad6a06386e6401985e19898715b1ea32ac03456fe1796d31ed4af389f4f675c23c421a125491e740fdac4322ec2d46ec945ddc349227b492191c9049145fb2f8c2998c486a840eac4d3
, e = 0x859e499b8a186c8ee6196954170eb8068593f0d764150a6d2e5d3fea7d9d0d33ac553eecd5c3f27a310115d283e49377820195c8e67781b6f112a625b14b747fa4cc13d06eba0917246c775f5c732865701ae9349ea8729cde0bbade38204e63359a46e672a8d0a2fd530069
, d = 0x27b7119a09edb827c13418c820b522a1ee08de0e4bb28106db6bb91498a3b361ab293af83fefcdd8a6bd2134ca4afacf64a0e33c014f48f47530f8847cc9185cbedec0d9238c8f1d5498f71c7c0cff48dc213421742e34350ca94007753cc0e5a783264cf49ff644ffea94253cfe86859acd2a2276ca4e7215f8ebaa2f188f51
, c = 0x6cf87c6a65925df6719eef5f1262edc6f8a0a0a0d21c535c64580745d9a268a95b50ff3be24ba8b649ca47c3a760b71ddc3903f36aa1d98e87c53b3370be784bffcb5bc180dea2acc15bb12e681c889b89b8f3de78050019dcdbb68c051b04b880f0f8c4e855321ffed89767fc9d4a8a27a5d82ba450b2478c21e11843c2f539
, m = 0x5c7bce723cf4da053e503147242c60678c67e8c22467f0336b6d5c31f14088cb3d6cefb648db132cb32e95092f3d9bcd1cab51e68bd3a892ab359cdff556785ae06708633d39a0618f9d6d70f6bdeb6b777e7dd9acc41f19560c71a68479c8a07b14fb9a4c765fd292ae56dd2f2143b62649cc70fb604fdc5cc1ade6e29de235 }


rsaTest1 = {
n = 0xc8883f0573e9a5f512fb65ed0adf2649b03237edf4faa6b259f89d7ed59d30d6fe052ef8dd68c9d672c9ac4ddb1edcf0102b8214dbd8478c7c87dfca0ad26cf5a9f73701e8525e059d1be2c568b42e39d0549bb772ed43135a39c79071b76e6604a05523be68ffa9b1c28f37f30bdb0bf78ddd85daff7054c9ab471bb483a065
, e = 0xa9e9df5a55fe9eeccd16fd651c2d7f13a9942e7418052b4ae1b98f8ca3f3e828532a453289bd47b363738f866debf04222abeecac1e11f980b6f115f097f4540aa7735b993f17f55083caeb6a80f80d092c59d2f895f783fab56a353b58a8c4316eacf3012c77e6fbfdb4be7
, d = 0x032ed7f38db0a3f026aa85f35c8835d8add52e62f631d5a99a6b6fe407c3711dc429cb5846b40fe560fd82b18a83bad21209382584e635ec21b38299d1651797246d69cbc0e23e674ce70a905109583a5b2ec87b0de762594c813f89c06d3ee2a19bfa0ffd78c26bb29d426f7647020434341b4735a2972b6aa653c662d710e7
, c = 0x49099483331a355f9e1e9446231f1f36d9a7cba76b83c06c6ec752dbf112342d5513e8285f4c7afb8b166e69a3e6f72991ce6a8d7247f163eb2d8419c00b1524a2990ba14983f23dc36c71530c337c55de75ca6dca538a64887552c28c4e5837d9a2e4391a4605efef28844e858f168269a3d58f9e2ff138eda6a3207c64632f
, m = 0xc847d03e2e5fa8ae543e35e47143bc6d0c172889418e2161398171222cd9aeac4c70f4e1e96425fe555fd492b8a5b45ae9a0af6ba22df257b6b354705819c9018c724032d54da56821f945d8fab1eada5107494a4e72d5ce98fccf03a8af05331f2a7121a0a9201494d1ce896a104323fd475d3e33d570d6cc426ea7f2b0646f
}



rsaTest2 = {
n = 0xa0a69a287b74fc5a179beab2d70485735763c78198e185906c3a57a25caf9983f61d4a80f7b57879ea38dd96cca717b93a148fefb6958ea7fc9ebf5b3eef90e21adbe5feea0dd76cd4b18538d59206ddc4e022feb75f3857f84c0714b76937c76e382bad3f28e11ffbefa235d0f41d642abfcbf9c10aff9ca1197b13783290eb
, e = 0xd2f24b31e027c0b9bc2929f2a2a38c9d003ae5b45d153957d2d0fe1cd05a87f375d050f6341d1e83f0583276902503259190aa7b0353e99a8b404da6feabe3a3b4a54263523a3619aedffe301db8be0aa07b04b8d8c1210cbb3034856d6f46dec94cf866558439083e26bd03
, d = 0x1c60340de5c8bf5b22f0f7f0532af217b303b70a4b64c03be2a89bb0e78571db4e49b74d12423e3712648e8751c43c4498176438fbb844960240e4878e382c8b8b11e548ce24b8c52ab8eba5ef6d4d6945e952fe0bae77208f88db1db5fc7df848c2b3daac8e15319cc0c6b3682a2aebd3fde60fda4a3142c317e521f6cf5ccb
, c = 0xb4b437586695ee63f908514864b9ac2e051cf157e6a612f63e3caf413becf1c8fedbb605e87eee34140d4465243502cf410e2e675d4cf9b1bbb95bd6b2e3f7f8ae1144c2777cee43b6bc7afcb5812a376683209ba7bcc5fec4d46c7a3ddd33c3ca402ab79df7b837e7fd3a369d03ec0f7c650d1c4b5c3e8460752c5465426ed2
, m = error "ciphertext representative out of range"
}


rsaTest3 = {
n = 0xbd74c62141cc4cf8228224d7e2de0d52b51e67e2d43676249470304d30d662ea3d6e5225101317369ae1de6bab944cde823d182cc0177f1905ca843611a2f67b9c32f975feccc8e9422b05d8831f0a013d8f9c68b1b8c25e5925d516414d34d57d84f38311bbebc7f1faf6548de9968e871f8e7e16b1fae5545d3f3cf04121b7
, e = 0xc08b122dd36a9965916287d08d8e2ece0500d4f1e37b45e29cb056efcd1449220d602e7cf13ec97b6c4f17a7e57af9c8ec65cb9864b7a4c83290855c8ffc55bc1da64e43b9ec4e9f266dce489d14aa8cda67cd50b638d8454a6854741126c4a07cc716330a37576e5021ca2f
, d = 0x0217f64f638419c8741b4b98a0678e40cb0e0c703a8c823224d88be40ea4d2bb8183233c9be2760ccff280a51ba714646344885212569ee9aaa80e610f2de30f42ef26a55bbb2bdbf31b9238036cb387be57067116e97386e9aac9cf2695e266873ef2944a4b010804408b039bd543a7f622983efdf56ec4ebb151ad80d5f4cf
, c = 0x97c4c0f9b86bf131e695932e891fddd63c46e87373bd6d6261fdd10f19dd5e21f362d4f131d82041e2216b2b074e5657f56c8471faa05ada4377029efd77b6a7bbfa3b30183cab7c9db278c7e59dae7dfee078aa130ee6b148c8ed42e646b086b833fd9cb5be1b49deeec3eb6a356caf2149cc04062f9b5038989ae11a71d426

, m = 0x3ed4d56d770a47b5a90c22d75fdc71b31a1fd54435de4375a06002cf13db50a012c5f5e5d94b7cfc85b5b3d9f5701d5d3aa75b5900ee0b09091c67d8ca33871228e041ae16138b1343bc3003af4aa21ff701d623dc40fcc0bad9848ec41be3a68ef8f9fdfbdbbd6df98f571a9d3fb8fad7c1e00ae3e72501a1182463b9971298
}



rsaTest4 = {
n = 0x8ae197e5bb30172ff378eb37f08709aa87b73802a027617fe959439399b3a0ae58ee46ec6e9fc3f29fa03ec08db9d16371dec03e9a6422d539cb4deb2dee52fd4dc1978f72cce77726886ce81c62b880f29623758aa615c65e500101d0980b2fba68e466a2545aeae7a3bfa6a549ce9a62ad7f171385feccbdfa902494d78443
, e = 0xf7dfd3273f5ec1a26fcc9d7df3c448f4c9ff6408bc35a26f6897875b2213ac6a6ccfc061ce46d6df12ec86f376377b51c9b4feccafbb8f3df628fd05af868a7d066aed834cdb9d9e3a3a5b60ded9799b40fa0edbbcc80b1808182f5eaeb77735213231178f3637cea7b9b0b7
, d = 0x2cd9eb9d91370fa049e778dc7b2eed16032a396d96d391f58df1c269ca2b354451bd13ffb929df047e356617f6d7394ca30622651d84823e7400805ea20d4eac617146eb8b11d0e53048c74ec02037e8b58946d95f10505dcb9dc468e5ade82fdec0edfafe09dd0bd2d13a07dbe96b741554b4806f4beeaa50562a1040e024af
, c = 0x3b888227ed25d10630057877e11ee54576a1d645402dbf2cec426ba350f8e59e65f199e98f8cb703255bd8302dd8e4ca675333d88e2ff2e2da4ec903c9caba3f1fe64d172b44ea5b4d588640b51c82b26d05cfeb9a365745fff5984cc25b9218734fe4da4ab532b4b0e2c9ce015386a6919ff4a7edabb4fe631d22a9c41335d0

, m = 0x19e5d33241cbc43c21d1c3eb21b9a48b2db1930c78b38321487212f82859cc5b989b77ee23c49de771ab9603ccf0631abeecabb90b4c7178b86db5aee994ed427fdabddf89def7643d0903379f1bb69f575d09472648d7050a77e8c06909dcd51b2edc194d7a9d632b210e883d2710a155f15b3cbb156cbdd7135024f671901c }


rsaTest5 = {
n = 0xb101bd9c2458804386e23d1b7a521430569b4f49029e87db288892159834d827bb2083272bb85bd5934e7ef6d458e40a8549ff338a7e6d84789207b15f824e39ebaefd2076f55c69121e9a90aab7c662734b50b4473c3342f7c57fdb6b891c2697eefe0917d20db468defef1d7acbec6f88390ccc6344b48b273a7d51081c4a5
, e = 0xb6c13349b9671c7bbce53881ac1112b0b83be497f42b1776c84acd0e9983b2ede9391126d81ddf249fc542fecf52269df27e64bf995a026b71ff631d3dfa8c84a14ebef82079ff92946188eba0c2a04b54c1f324c073081f38380719ab64359dddcb826624975b1d37a43bd7
, d = 0x22107d6ec7bdf09c9f688448bfae94cdf7268bd72afc96e4ad9d7501b04afe69df7b4274fe90b8f35e1cbf03b71a097489c619d2b87ef0024a6f2c2f1bf7f827c891bf7e42bf1f9a3b973ff0305f5de643092da60d9f039b51902e1b07990d5f3e1f360de4084e92f9bbfe95a51105dd58c266384c5ec815d380eea8dfb248af
, c = 0x400e4f3d5498a2b5d695618f4599a80639e875b049d1af692d3d678c20875d6a888ec6f4d9094cbbb71b571b5b288bb237e69217ddb71bc91d3622666d0f721e8f1569666d8efcf148d1fadc11149529177f1e6ee38510ce607350294049b3909acac1fcd8cfb93fd0e0d53a3105ce5121daa31c24e2975f401d783d5fdd27a8

, m = 0x53fe9fdbc8de44c4a0c073f4ed9ba8b2769174fa1c29814528221c223e4dcd42435f3ca8db857a8cc056dd8155369c45d5d6339ace54b77ae4ccdd8180ec0a251c5599cdc5187c5a055ba1cd97e2ac6f43d6a85bce3646dcd2e0342a6d3a165febfae367b79c719ede2940345c55ae9d6106d4f94be9b03cb561f3759304792b
}


rsaTest6 = {
n = 0xab04b223f82347bab2547e2cc0abb18ffda653a5284916d90a1fb4c24315a18c778709b18a71abe1a385b305d25813308467d2c29263ca468d5c12e519f8749f267d17df5398b473fbfac9f5b4e98cf5c90e5a65d1a4561c69d82616f1a379bf2c1d0f8477e5339d925082a0bab01f8823d4e46ace967cc526985e03c0e52a4f
, e = 0xe23bc7155efb1817eae0633b99b178ec507dfce68c2ce2631a625123ebe9cf0b8c142464ed1766b69d7eb5c50bc8c63238b615ebfce42d087ed87c6cb3cd7d83d561dd350f9aee914cb73edcbfcb307e1cf03ea2be449e902d3c15d582c446d9e92eecb5e5fbca71054a857f
, d = 0x060a93b479b6b56f7655fccf0770321733cedc646711244f08d12b56456e360b879c4007df0d93f35b57b7c51cd1b4f624631d5c3d656d6c67866001f5668a318bdc5259381db72eb50995c95cfdc45fbc3902bc65a1ce9dc92d1622e087db9f6abbee353371d700d5c2efcce47dd044bf5061853e729cdc28bd407837d93bb7
, c = 0x1649ac3e49126af973c4065224bc36b46be21855f63775687aae4695563d77a67333ec836eccc260f903d7357ea78c6e06b1c9e45ad5420d6757f96fe720045b3e1191d7a29727dc7f802fc21a0db2f8744864f87197e27a399238e8df12a613418aa4242f9b23d5cfe216e13f1531b87d4ef07884a6dc19b8060ae7843ae436

, m = 0x89219746564489c208be153f337de445c517ef25060a5557f49bfb639085c2130cd8130df14cae49d9541e0418afe3d889356977270c9f39bca1944ada92fc115fd83078317e18c0d927d1d5a7825524e5f5b7d1b5d40a28187e05197f66888310fc2d23dba232c352758cf2f16b20911c96363475edb33caee52e16750fbe61
}

rsaTest7 = {
n = 0x9d6c06ee50f4528b0d44ab99a87d27f180a73e8fd98512b11cd795fd417173cf44a55f050f5c1df9a80a4917230b4c9a2d4c76e36e4c845abe717e8384e0fe312429ead5a02d0ed98b37c85d034dc88f42d756546215df2bd5c739c1d43b3a37841caa7ade44be1e089eb0bd7cd7205e66cf7539d8ea1126d21b9a6411430c2b
, e = 0x6367395890cd978cfd461fe82f3bb22f074c6c33ec4ccf395799ab830fbcc73196c8d52f036b4737cc82a3bc596fb56ccb664c98abd4fc3f21682bf7d1f58dc7ec16c3c10da1827e071d840349c281b57f7d11c7f67432f04da27baff2beee40a9f9dd3f39ec1201fcfaa04b
, d = 0x16de900b71da7850b6c774035beecac0861b29ca03903020b2cf8d573f160a36ed73ac4e28c57a17f460d2ca400a48a239cc2aca97903c9eaae57a1c6d39148a9465795ed87116cd82445eb4998ed913cd3b01c19e08cf91a212a03479fdc1e4db717d0ddf04bd35c17da598f0b7d0dee5a5379ead70e939fdb12f99572bd4fb
, c = 0x8f9157d36a2f306d6524e7cef4a036d25380db51ca7ef9f430a5bb47ae093a0fc5b4a1dd92e38fe35173bc072196e03606cad0fb340cea508b48b4b45e15c07d789fd37061e4458fdd24ab32b692b459bb505141099a19358942eba7ba5cd57fb13a34b35e9b1d18101ffc783bfe7be47afaa64bd0924c4c3379a8494b4640bd

, m = 0x2db5ade74b4c168f894c1588f61754b6d5db8e4b62cd95ed9d13c9795d8cd8187d125c02d688086110c4de61bb7d9346c656cc89effc6cc945812e696b201fa8e4571ee74aabab931cf034a77a1f77c2649fe75ecebb0f772a765fd833589e4f337262d1a15a966d3072b760aec506f268f1e359ef611de5a7e4fd1241f40583
}

rsaTest8 = {
n = 0x977884e88c0c8127709843af6d37c02b2394851ea2313ef7f8f95ee02c57e71ebccfd3933f6cd146bb427b0631f5eaafb9e1d9ffeb4a79be75360e0af1299844c9bf896bd3fffb27af43749bbe80868c37ecb8e105063aef02942b57cf8de5f4b573b8835e75e010f76d218e7d69fa573e640983d5b6ebb7ff992c28a9f6048b
, e = 0x110b390d11c13574297784180be412ff866338e1e8a3a1c0f885e07b4cb38b2836dc1307ce2fc60abd9a47ca24ddfe030f470060a07f742f2a61d1861dbbab3ea6d7654fc1271b0a53a3319215334aafc6d22b8e29913f15be747ec36b7623fbf1c9c32f12a5493fe585e2d
, d = 0x2958f931484c2f635a86822e4bfdd7ae7c45b854b573d1278a9f699e47354236edeb18497e2d6faadea7c652af9384abf9033dfd20deb4a6811e7a6dcda4a6716d20897a0facd19f61a115101ae4b3c3f77f0fae83ac2cfe3f5855f2e854f5693df67cf76fb4c4d54da15b711dfffafae9aafbea76726efefa44613a74ed9025
, c = 0xbe28192aff56f98a1c822e03a44de0ee1d78e0abf50539e5bc99081690258d4dd8c5812f35e9aa3bb5b2ae534a9f25787b68f1d65a2ad200b6c5357c91824d82d4fa6501423375e3ab0bf39262daebbbf15352520aab98d6c1fe7cd6f9ee24b41c8d6da9107d80096655a6c8d4475d3ee500ab27efd0b2ee460b852bafaf3a6a
, m = error "message representative out of range"
}

rsaTest9 = {
n = 0xa5be019172ef33f82061aae0e88aa81fae292b3e1c0b33220c5822dbc9acdbec2eb7b0fbfae1e9160c47277a85e047c629686cb40be50f2a676bfa702c773cd24ce80a6c07f3c2d9d65029abe0c876cdf3b9f6ca1b4ce8edb74aeb3c63dcd1448de20ee97063a26450bf4db8b83a4f16b9e3ea146aba454b72ba1cca615752bd
, e = 0xc06312d850e541be4b24c664811e80cb0a8d4ed6b21f1533d55477d1b8ac8e4b25441b52f75a90c23e7c81b42da33e9f7d6a02b8c172a8341aec8222fa2f9540a64c79a0e8837c0b02c82f75aa0a529bb715f2aa7bbe5d63f9e346a354be5b4aaf95a52abdc71ec6ed171581
, d = 0x22595b2c5ad55e4a96dce4733064e1338ceabf00a2fe2df5ae8afc7990ace25a036732c06f3170844868bc854d8408ac49856bca8314b54b2fefefe0393920da3c4db3e62d8969da7a42f89d93c79954170082db7a44c25780ed7ed21c6475d125877ea1954310bf91031ba2ae6422a15e9b67868224bf6050839cc0ea331f3d
, c = 0x067aa5f930e6e5f25b5fcb93c57d9cda00d8a6aeeb25d420e1a281f030b58a53cdcfa7f34697fb38f745e9c6814b2a47783b1c6a5ce55d2bcbbf9956f48ba0464f33bcf38cf8412cc9cb652007fb5223df117aaf71f92ba99e6263e67766e5eef46e8c00ea50e05637bbe7a93fd53ef89d22678612a86522c15186aa9f9081d2

, m = 0x384e297946360d798abdaf2a71ae3b5d5222c7c874260879c4db0d663ae185ae2ccea35170e23707a380dd4230de9b52e0b2aea273545663bf816886f1b528f251ebfffc778c19dff5ed151a469490aa9ec7238d2e681ac33b8418eac5056045bcd90f1490ba6c52493c3af831b1a3851166bff56e85994ae1531c16b14bec95
}

rsaTest10 = {
n = 0xaae790ce66165e1431df2b6234497b11994653c3f70e1724123b5adfb993daafbee368707554d7392314340abe052b6f7f28a6e4528919ed77ee2d0ec7e58ba3503c61d41274af784ea38f9a5ede616cccf011da8c4d7d46103dc29d166f1424a1a19d79e6a3acae603de797f1caac0fd3ecf246c40376fceca0931b164044d5
, e = 0xc690888a046c216cf843d63b0a71eb930063bbdb884d4c9efd372339bf2bef0fd77793eda3d89508c83719acd72725df7a456c5acfaa54ad27fafcf461e92981322977a38543f3af1c1cd8027e4a4f35b16e1657cfc7ed6ab932fffb0dfd75374195e5fc3f30a36b0eb2ab17
, d = 0x194c170c8407fe3c9aa81d193f92d933bf49a05af50332b1f6deaa442d85a04580716af33136655881d4b2e50aaed19c5d22c28f755c834bf8c045eaadc0376ee4f0e22779196bf0029fbf0501589338d993c626167b5e576d20b533a150470ab6c0e4bb30a091321a8f63fd2c8a2cfe1e9a9e09ae43a14ba6066823139b56a7
, c = 0x888c45bc9f8faa8893f2013c8917badc88bd25c588c62b92cc3d3c3d7297888649397299e23b41ebea6c1965b6962bc420032840923ffb6b6020b75d5b04ce0ea35a8503bc64a42de43a720ea413e01da6c0056cc679ca886bdce7a018330eea3ef6654355913a162a66f37e7b1643afc1fca4924dfb01af967ab250d2acaee3
, m = 0x0b6730cdf0f4e8106edfef36437d3a03a2a62f56a26dae5440c487db56684016e617a4301cded9f91da454f4cb498ade5061f42d6af2be01a27474e332e308029d66ab392963e2f92550132bafc1ccb624d6e5e36cb334e50d0473afb3a6a600757f8caa92f83599c8f6a7fc4df348ec0418e6baa529a9b2ebcebe754839c505
}

property testsPass = and [x.m == RSADP ((x.n, x.d), x.c)
                         | x <- [rsaTest0, rsaTest1, rsaTest3, rsaTest4, rsaTest5, rsaTest6, rsaTest7, rsaTest9, rsaTest10]]
